# Bootstrap settings for capictl + Hetzner Cloud (CAPH)
#
# IMPORTANT: Do NOT put real credentials in this file.
# Copy it to .env, fill in your values there, and source it:
#
#   cp clusterctl-settings.env .env
#   # edit .env with real values
#   ./bootstrap.sh
#
# The .env file is git-ignored and will not be committed.
#
# Prerequisites:
#   - A pre-baked Hetzner snapshot must exist before running bootstrap.sh:
#       cd packer && packer init . && packer build -var 'kubernetes_version=1.31.6' ubuntu.pkr.hcl
#   - Tools: docker, kind, kubectl, clusterctl, hcloud, flux, helm, jq, yq

# ─── Hetzner API ────────────────────────────────────────────────
# Create at https://console.hetzner.cloud → Security → API Tokens (Read+Write)
export HCLOUD_TOKEN="<your-hetzner-cloud-api-token>"

# ─── Cluster Settings ──────────────────────────────────────────
export CLUSTER_NAME="dkpbot-prod"
export KUBERNETES_VERSION="1.31.6"        # Must match the Packer image version
export HCLOUD_REGION="nbg1"              # Nuremberg; also: fsn1, hel1
export CONTROL_PLANE_MACHINE_COUNT=1
export WORKER_MACHINE_COUNT=1

# ─── Machine Types ─────────────────────────────────────────────
export HCLOUD_CONTROL_PLANE_MACHINE_TYPE="cx23"
export HCLOUD_WORKER_MACHINE_TYPE="cx23"

# ─── Image (optional) ──────────────────────────────────────────
# capictl auto-selects the latest snapshot with label caph-image-name.
# Override to pin a specific image:
# export IMAGE_NAME="ubuntu-24.04-amd64-k8s-1.31.6"

# ─── FluxCD / GitHub ──────────────────────────────────────────
# Personal access token with repo scope (for Flux bootstrap).
# If not set, the script tries: gh auth token
export GITHUB_TOKEN="<your-github-pat>"
export GITHUB_USER="jensholdgaard"

# Git branch for Flux to track. Defaults to "main".
# export FLUX_BRANCH="main"

# ─── Discord Bot Credentials ───────────────────────────────────
# These populate the dkpbot-secrets Kubernetes Secret.
# Leave as REPLACE_ME to set them manually after bootstrap.
# export DISCORD_TOKEN="<your-discord-bot-token>"
# export DISCORD_GUILD_ID="<your-discord-guild-id>"

# ─── CNPG Backup — Hetzner Object Storage (S3) ───────────────
# Create at Hetzner Cloud Console → Object Storage → S3 Credentials
export CNPG_S3_ACCESS_KEY="<your-hetzner-s3-access-key>"
export CNPG_S3_SECRET_KEY="<your-hetzner-s3-secret-key>"
export CNPG_S3_ENDPOINT="https://nbg1.your-objectstorage.com"
export CNPG_S3_BUCKET="dkpbot-backups"
